<!DOCTYPE html>
<html>

<head>
	<title>Socket.IO chat</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
</head>

<body>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
$(function(){

	var socket = io();

	socket.on('message', function(who, data){
		data = JSON.parse(data);
		$('#messages').append('<li>' + who + '&nbsp;wrote:&nbsp;' + data.message + '&nbsp;(&nbsp;' +  data.type + '&nbsp;)' + '</li>');
	});


	$('form').submit(function(){
		var data = {
			id: socket.id,
			message: $('#m').val(),
			type: 'userMessage'
		};
		socket.send(JSON.stringify(data)); //socket.send sends messages which are received with the 'message' event
		$('#m').val('');
		return false;
	});


	$('#setname').click(function(){
		socket.emit("set_name", $('#nickname').val())
	});


	socket.on('name_set', function(who){
		$('#nameform').hide();
		$('#messages').append('<li>' + 'Hallo '+ who + '&nbsp;!' + '</li>');
	});

	
}); // end jQuery
</script>

<!--- choose nickname ---->

	<section id="nameform">
		<div class="backdrop"></div>
		<div class="popup">
			<div class="pophead">Bitte Nicknamen eingeben:</div>
			<div class="popbody">
				<input id="nickname" type="text"/>
				<input id="setname" type="button" value="bestÃ¤tigen">
			</div>
		</div>
	</section>

<!--- chat window ---->

	<ul id="messages"></ul>
		<form action="">
			<input id="m" autocomplete="off"/><button>Send</button>
		</form>

</body>
</html>